#!/usr/bin/env bash

set -euo pipefail

user_repo="${1:-}" # e.g bartekpacia/dotfiles

if [ -z "$user_repo" ]; then
	echo "user_repo is empty"
	exit 1
fi

echo "GITHUB_TOKEN=$GITHUB_TOKEN"

auth=""
if [ -n "$GITHUB_TOKEN" ]; then
	echo "GITHUB_TOKEN IS NOT EMPTY"
	auth="-H Authorization: token $GITHUB_TOKEN"
	echo "auth=$auth"
fi

# echo "auth=$auth"

curl -s "$auth" "https://api.github.com/repos/$user_repo/releases/latest" \
	| grep browser_download_url
	# | grep linux-amd64 \
	# | cut -d '"' -f 4

#!/usr/bin/env bash
set -euo pipefail

# Example usage: 
# $ gh_release atom/atom

user_repo="${1:-}" # e.g bartekpacia/dotfiles

if [ -z "$user_repo" ]; then
	echo "user_repo is empty"
	exit 1
fi

auth=""
if [ -n "$GITHUB_TOKEN" ]; then
	auth="-H Authorization: token $GITHUB_TOKEN"
	echo "authorizing with GITHUB_TOKEN"
fi

curl -s ${auth:+$auth} "https://api.github.com/repos/$user_repo/releases/latest" \
	| grep browser_download_url
	# | grep linux-amd64 \
	# | cut -d '"' -f 4
